/*!
 * @autofe/floornav v0.5.1
 * (c) 2018 Autohome Inc.
 * Released under the MIT License.
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("jquery")):"function"==typeof define&&define.amd?define(["jquery"],e):(t.AutoFE=t.AutoFE||{},t.AutoFE.Floornav=e(t.jQuery))}(this,function(t){"use strict";t=t&&t.hasOwnProperty("default")?t.default:t;var e="floornav",i="fe.floornav",o="."+i,n=t.fn[e],s={SCROLL:"scroll"+o,RESIZE:"resize"+o,CLICK:"click"+o},r={ITEM:"a[href]"};function h(e,i){var o=this;this.options=t.extend({},h.Default,i),this.$elem=t(e),this.$items=t(e).find(r.ITEM),this.targets=[],this.$items.each(function(e,i){var n=t(i.getAttribute("href"));n&&n.length>0&&o.targets.push(n)});var n=t(i.container)[0];"BODY"!==n.tagName&&"HTML"!==n.tagName||(n=window),this.$container=t(n),this._$scroll=this.$container,n===window&&(this._$scroll=t("html,body")),this._timer=null,this.isShown=!1,this.init()}function a(e,o){return this.each(function(){var n=t(this),s=n.data(i),r=t.extend({},h.Default,n.data(),"object"==typeof e&&e);if(s||(s=new h(this,r),n.data(i,s)),"string"==typeof e){if("undefined"==typeof s[e])throw new TypeError('No method named "'+e+'"');s[e](o)}})}return h.Default={container:window,base:"center",threshold:0,scrollOffset:0,activeClass:"active",showClass:"show"},h.prototype.init=function(){this._initJump(),this._initCheck(),this.check()},h.prototype.check=function(){var t=this,e=this.options.threshold,i=this.options.base,o=this.$container.height(),n=void 0,s=0;this.$container[0]!==window&&(s=this.$container[0].getBoundingClientRect().top),n="top"===i?s:"bottom"==i?s+o:s+o/2,this.targets[0][0].getBoundingClientRect().top<=n+e?this.isShown||(this.$elem[0].style.display="block",setTimeout(function(){t.$elem.addClass(t.options.showClass)},0),this.isShown=!0):this.isShown&&(this.$elem.removeClass(this.options.showClass),this.$elem[0].style.display="none",this.isShown=!1);for(var r=this.targets.length-1;r>=0;r--){var h=this.targets[r];if(h[0].getBoundingClientRect().top<=n+e){var a=h.attr("id"),c=this.$elem.find('a[href="#'+String(a)+'"]');this._setItemActive(c);break}}},h.prototype.update=function(){var e=this;this.$items=this.$elem.find(r.ITEM),this.targets=[],this.$items.each(function(i,o){var n=t(o.getAttribute("href"));n&&n.length>0&&e.targets.push(n)})},h.prototype._initJump=function(){var e=this;this.$elem.on(s.CLICK,r.ITEM,function(i){i.preventDefault();var o=t(i.target),n=t(o.attr("href"));e._setItemActive(o),e._scrollTo(n)})},h.prototype._initCheck=function(){var t=this;this.$container.on(String(s.SCROLL)+","+String(s.RESIZE),function(){t._timer||(t._timer=setTimeout(function(){t.check(),clearTimeout(t._timer),t._timer=null},100))})},h.prototype._scrollTo=function(t){var e=this;if(t&&!(t.length<=0)){this.$container.off(s.SCROLL),this.$container.off(s.RESIZE);var i=!1,o=0;this.$container[0]!==window&&(o=this.$container.offset().top-this.$container.scrollTop());var n=this.options.scrollOffset;this._$scroll.stop().animate({scrollTop:t.offset().top-n-o},150,function(){i||(i=!0,e._initCheck())})}},h.prototype._setItemActive=function(t){var e=this.options.activeClass;t.hasClass(e)||(this.$items.removeClass(e),t.addClass(e))},t.fn[e]=a,t.fn[e].Constructor=h,t.fn[e].noConflict=function(){return t.fn[e]=n,a},h});