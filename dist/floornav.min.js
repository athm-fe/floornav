/*!
 * @autofe/floornav v0.5.0
 * (c) 2018 Autohome Inc.
 * Released under the MIT License.
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("jquery")):"function"==typeof define&&define.amd?define(["jquery"],e):(t.AutoFE=t.AutoFE||{},t.AutoFE.Floornav=e(t.jQuery))}(this,function(t){"use strict";t=t&&t.hasOwnProperty("default")?t.default:t;var e="floornav",i="fe.floornav",o="."+i,s=t.fn[e],n={SCROLL:"scroll"+o,RESIZE:"resize"+o,CLICK:"click"+o},r={ITEM:"a[href]"};function h(e,i){var o=this;this.options=t.extend({},h.Default,i),this.$elem=t(e),this.$items=t(e).find(r.ITEM),this.targets=[],this.$items.each(function(e,i){var s=t(i.getAttribute("href"));s&&s.length>0&&o.targets.push(s)});var s=t(i.container)[0];"BODY"!==s.tagName&&"HTML"!==s.tagName||(s=window),this.$container=t(s),this._$scroll=this.$container,s===window&&(this._$scroll=t("html,body")),this._timer=null,this.isShown=!1,this.init()}function a(e,o){return this.each(function(){var s=t(this),n=s.data(i),r=t.extend({},h.Default,s.data(),"object"==typeof e&&e);if(n||(n=new h(this,r),s.data(i,n)),"string"==typeof e){if("undefined"==typeof n[e])throw new TypeError('No method named "'+e+'"');n[e](o)}})}return h.Default={container:window,base:"center",threshold:0,scrollOffset:0,activeClass:"active",showClass:"show"},h.prototype.init=function(){this._initJump(),this._initCheck(),this.check()},h.prototype.check=function(){var t=this,e=this.options.threshold,i=this.options.base,o=this.$container.scrollTop(),s=this.$container.height(),n=void 0,r=0;this.$container[0]!==window&&(r=this.$container.offset().top-o),n="top"===i?r+o:"bottom"==i?r+o+s:r+o+s/2,this.targets[0].offset().top<=n+e?this.isShown||(this.$elem[0].style.display="block",setTimeout(function(){t.$elem.addClass(t.options.showClass)},0),this.isShown=!0):this.isShown&&(this.$elem.removeClass(this.options.showClass),this.$elem[0].style.display="none",this.isShown=!1);for(var h=this.targets.length-1;h>=0;h--)if(this.targets[h].offset().top<=n+e){var a=this.targets[h].attr("id"),f=this.$elem.find('a[href="#'+String(a)+'"]');this._setItemActive(f);break}},h.prototype.update=function(){var e=this;this.$items=this.$elem.find(r.ITEM),this.targets=[],this.$items.each(function(i,o){var s=t(o.getAttribute("href"));s&&s.length>0&&e.targets.push(s)})},h.prototype._initJump=function(){var e=this;this.$elem.on(n.CLICK,r.ITEM,function(i){i.preventDefault();var o=t(i.target),s=t(o.attr("href"));e._setItemActive(o),e._scrollTo(s)})},h.prototype._initCheck=function(){var t=this;this.$container.on(String(n.SCROLL)+","+String(n.RESIZE),function(){t._timer||(t._timer=setTimeout(function(){t.check(),clearTimeout(t._timer),t._timer=null},100))})},h.prototype._scrollTo=function(t){var e=this;if(t&&!(t.length<=0)){this.$container.off(n.SCROLL),this.$container.off(n.RESIZE);var i=!1,o=0;this.$container[0]!==window&&(o=this.$container.offset().top-this.$container.scrollTop());var s=this.options.scrollOffset;this._$scroll.stop().animate({scrollTop:t.offset().top-s-o},150,function(){i||(i=!0,e._initCheck())})}},h.prototype._setItemActive=function(t){var e=this.options.activeClass;t.hasClass(e)||(this.$items.removeClass(e),t.addClass(e))},t.fn[e]=a,t.fn[e].Constructor=h,t.fn[e].noConflict=function(){return t.fn[e]=s,a},h});